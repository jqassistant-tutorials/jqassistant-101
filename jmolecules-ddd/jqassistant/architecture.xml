<jqassistant-rules
        xmlns="http://schema.jqassistant.org/rule/v2.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://schema.jqassistant.org/rule/v2.0 https://schema.jqassistant.org/rule/jqassistant-rule-v2.0.xsd">

    <!-- tag::content[] -->
    <!-- tag::architectureGroup[] -->
    <group id="architecture:Default">
        <includeConcept refId="architecture:*"/>
        <includeConstraint refId="architecture:*"/>
    </group>
    <!-- end::architectureGroup[] -->

    <!-- tag::aggregates[] -->
    <constraint id="architecture:AggregateRepository">
        <requiresConcept refId="jmolecules-ddd:AggregateRoot*,jmolecules-ddd:Repository*"/>
        <description>
            Only aggregates are allowed to be returned by repositories.
        </description>
        <cypher><![CDATA[
            MATCH
                (repo:JMolecules:DDD:Repository)-[:DECLARES]->(:Method)-[:RETURNS]->(t:Type)
            WHERE
                NOT t:JMolecules:DDD:AggregateRoot
            RETURN
                repo.fqn as Repository, t.fqn as IllegalReturnType
        ]]></cypher>
    </constraint>
    <!-- end::aggregates[] -->
    <!-- tag::boundedcontexts[] -->
    <concept id="architecture:BoundedContextOverview">
        <requiresConcept refId="jmolecules-ddd:*"/>
        <description>
            Documentation of existing bounded contexts and their dependencies.
        </description>
        <cypher><![CDATA[
            MATCH
                (bc1:DDD:BoundedContext)
            OPTIONAL MATCH
                (bc1)-[d:DEFINES_DEPENDENCY|DEPENDS_ON]->(bc2)
            WHERE
                bc1 <> bc2
            RETURN
                bc1, d, bc2
        ]]></cypher>
        <report type = "plantuml-component-diagram"/>
    </concept>
    <!-- end::boundedcontexts[] -->
    <!-- end::content[] -->

</jqassistant-rules>