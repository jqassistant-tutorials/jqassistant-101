<jqassistant-rules
        xmlns="http://schema.jqassistant.org/rule/v2.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://schema.jqassistant.org/rule/v2.0 https://schema.jqassistant.org/rule/jqassistant-rule-v2.0.xsd">

    <!-- tag::content[] -->
    <!-- tag::adrGroup[] -->
    <!--1-->
    <group id="adr:DeepLinking">
        <includeConstraint refId="adr:DeepLinking:*"/>
    </group>
    <!-- end::adrGroup[] -->

    <!-- tag::adrConstraint[] -->
    <!--2-->
    <constraint id="adr:DeepLinking:NoDeepLinkingBetweenAggregates">
        <!--3-->
        <requiresConcept refId="jmolecules-ddd:*"/>
        <!--4-->
        <description>
            Finds all entities that are referenced by more than one aggregate.
        </description>
        <!--5-->
        <cypher><![CDATA[
            MATCH
                (a:JMolecules:DDD:AggregateRoot)-[:DEPENDS_ON*]->(e:JMolecules:DDD:Entity)
            WITH
                e, collect(a.name) AS aggregates
            WHERE
                size(aggregates) > 1
            RETURN
                e.name AS Entity, aggregates AS Aggregates
        ]]></cypher>
    </constraint>
    <!-- end::adrConstraint[] -->
    <!-- end::content[] -->

</jqassistant-rules>